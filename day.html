<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snowy Whispers of the Moon</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="moonlight-overlay"></div>
  <div class="snow-layer"></div>

  <div class="content">
    <div id="riddle-container" class="fade-in">
      <p id="riddle-text"></p>
      <input type="text" id="answer" placeholder="Your answer..." />
      <button id="submit-answer">Unlock</button>
      <p id="feedback"></p>
    </div>

    <div id="story-container" class="fade-in" style="display:none;">
      <h2 id="day-title"></h2>
      <p id="day-story"></p>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
  <script src="riddles.js"></script>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const day = parseInt(urlParams.get("day")) || 1;
    const riddleData = riddles[day-1];

    const riddleText = document.getElementById("riddle-text");
    const answerInput = document.getElementById("answer");
    const feedback = document.getElementById("feedback");
    const storyContainer = document.getElementById("story-container");
    const dayTitle = document.getElementById("day-title");
    const dayStory = document.getElementById("day-story");
    const submitButton = document.getElementById("submit-answer");

    const dayKey = `day${day}Solved`;

    riddleText.textContent = riddleData.question;

    if(localStorage.getItem(dayKey) === "true") revealStory();

    submitButton.addEventListener("click", () => {
      const userAnswer = answerInput.value.trim().toLowerCase();
      if(md5(userAnswer) === riddleData.answerHash){
        feedback.textContent = "✨ The whisper is revealed...";
        feedback.style.color = "#cce6ff";
        setTimeout(() => {
          localStorage.setItem(dayKey, "true");
          revealStory();
        }, 800);
      } else {
        feedback.textContent = "That doesn’t sound quite right...";
        feedback.style.color = "#ffb3b3";
      }
    });

    function revealStory(){
      document.getElementById("riddle-container").style.display = "none";
      storyContainer.style.display = "block";
      dayTitle.textContent = riddleData.title;
      dayStory.textContent = riddleData.story;
      document.body.classList.add("revealed");
    }
  </script>
</body>
</html>